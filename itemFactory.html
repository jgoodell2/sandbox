<!-- stated with this prompt but needed to fix: create a web form with JavaScript code to autogenerate variations of the following html allowing the user to enter minimum and maximum values for a, b, and c iterates through all possible values of 
a, b, and c using nested for loops. It then calculates the sum of each combination of values and outputs it: <p> ${a} + ${b} + ${c} = ${d}<\p> -->
<!-- https://htmlpreview.github.io/?https://github.com/jgoodell2/sandbox/blob/main/itemFactory.html -->

<!DOCTYPE html>
<html>
<body onload="resetPage()">

  <h2>Autogenerate Variations of OER Assessment Items and Other HTML Micro-Learning Experiences</h2>

  <div id="step1">
    <h3>Step 1: Enter Parameterized HTML for Interactive Item</h3>
    <textarea id="template" name="template" rows="4" cols="50">Enter template html with parameters here.</textarea>  
    <p>Example: \<p>Solve for d: ${a} + ${b} + ${c} = d\</p></p>
    <button type="button" onclick="parseTemplate()">Parse Template</button><br><br>
  </div>
  
  <div id="step2">
    <h3>Step 2: Enter Ranges and Rules for Autogeneration</h3>
    <form id="paramForm"></form>
  </div>
  
  <div id="step3">
    <h3>Step 3: Enter Metadata</h3>
    <form id="metadataForm">
      <label labelFor="xApiProfileUrl">xAPI Profile URL:</label>
      <input type="text" id="xApiProfileUrl">*
    </form>
  </div>
  
  Result:
  <div id="d" name="d">--result here--</div>


  <script>
    function resetPage() {
      document.getElementById("step1").style.visibility = "vissible"; // Show step 1
      document.getElementById("step2").style.visibility = "hidden"; // Show step 2
      document.getElementById("step3").style.visibility = "hidden"; // Show step 3
      alert("Debug: Page loaded");
    }
    
    function parseTemplate() {
      const str = document.getElementById("template").value;
      const regex = /\${(.*?)}/g;
      const params = [];
      let match;
      while ((match = regex.exec(str))) {
        params.push(match[1]);
      }
      const arr = [];
      for (let i = 0; i < params.length; i++) {
        const innerArr = [];
        innerArr.push(params[i]);
        innerArr.push(0);
        innerArr.push(0);
        innerArr.push(0);
        arr.push(innerArr);
      }
      // Create form table to enter parameter ranges and rules based on template parameters
      const paramFormTableHTML = "<table>";
      for (let i = 0; i < arr.length; i++) {
        // Each row has inputs for min max and step 
        paramFormTableHTML += '<tr><td>' + arr[i][0] +':</td><td>min value:<input type="number" id="param' + i + 'min" name="param' + i + 'min"></td>';
        paramFormTableHTML += '<td>max value:<input type="number" id="param' + i + 'max" name="param' + i + 'max"></td>';
        paramFormTableHTML += '<td>increment by:<input type="number" id="param' + i + 'step" name="param' + i + 'step"></td></tr>';
      }
      paramFormTableHTML += '<tr><td colspan=3>exclude items if answer: <select id="excludeIfOperator" name="excludeIfOperator"><option value="lt">\<</option><option value="eq">=</option><option value="gt">\></option></select><input type="number" id="excludeIfValue" name="excludeIfValue"></td></tr>';
      paramFormTableHTML += '<tr><td colspan=3>answer formula:<input type="number" id="answerFormula" name="answerFormula"></td></tr></table>';
      paramFormTableHTML += '<button type="button" onclick="gotoStep3()">Next</button><br><br>';
      document.getElementById("paramForm").innerHTML = paramFormTableHTML;
      document.getElementById("step2").style.visibility = "visible"; // Show step 2
    }
  

    function gotoStep3() {
      document.getElementById("step3").style.visibility = "visible"; // Show step 3
    }
    
    function calculate() {
      var a_min = parseInt(document.getElementById("a").min);
      var result = "";
      for (var a = a_min; a <= a_max; a++) {
        for (var b = b_min; b <= b_max; b++) {
          for (var c = c_min; c <= c_max; c++) {
            var d = a + b + c;
            result += "<p>" + a + " + " + b + " + " + c + " = " + d + "</p>";
      }
    }
  }

  document.getElementById("d").innerHTML = result;
}
</script>

</body>
</html>


